!function(e,t){"function"==typeof define&&define.amd?define(function(){return e.ambient=t()}):"object"==typeof exports?module.exports=e.ambient=t():e.ambient=t()}(this,function(){function e(){b(t)}function t(){var e,t,a,i,r,c={};m=[];for(e in s)if(s.hasOwnProperty(e)){i=[],s[e].updated=!1;for(t in s[e])if(s[e].hasOwnProperty(t)&&w[t]){if(a=w[t],null==c[t]&&(c[t]=a.getCurrentValue(),c[t]!==a.currentValue?(a.currentValue=c[t],a.updated=!0):a.updated=!1),s[e].updated=s[e].updated||a.updated,a.updated?(r=a.getActiveClasses(a.currentValue,e,s[e][t]),a.cache[e].activeClasses=r):r=a.cache[e].activeClasses,!r.length){i=[];break}i=i.concat(r)}m=m.concat(i)}m=m.filter(function(e,t,n){return n.indexOf(e)===t}),n(),l=null}function n(){var e,t,n=x.className;for(v=n.split(" ").filter(function(e){return-1!==p.indexOf(e)}),e=m.length;e--;)t=m[e],-1===v.indexOf(t)&&(n+=" "+t,s[t]&&o("enter",t)),s[t]&&o("update",t);for(e=v.length;e--;)t=v[e],-1===m.indexOf(t)&&(n=n.replace(new RegExp("(^|\\s)"+t+"($|\\s)","g")," "),s[t]&&o("leave",t));x.className=n.split(" ").filter(function(e){return e}).join(" ")}function a(){l||(d?l=setTimeout(e,d):e())}function i(e,n){var i,r,c,o,u={};if(!h){s=e||{},p=[];for(i in s)if(s.hasOwnProperty(i))for(c in s[i])s[i].hasOwnProperty(c)&&w[c]&&(r=w[c],r.cache=r.cache||{},r.cache[i]=r.cache[i]||{},r.watchElement=r.watchElement||E,o=r.getAllClasses?r.getAllClasses(i,s[i][c]):[i],p=p.concat(o),u[r.watchEvent]&&-1!==u[r.watchEvent].indexOf(r.watchElement)||(r.watchElement.addEventListener?r.watchElement.addEventListener(r.watchEvent,a,!1):r.watchElement.attachEvent("on"+r.watchEvent,a),u[r.watchEvent]=u[r.watchEvent]||[],u[r.watchEvent].push(r.watchElement)));"number"==typeof n&&(d=n),h=!0,t()}}function r(e,t,n){var a,i,r=e.split(" ");for(g[t]=g[t]||{},a=r.length;a--;)i=r[a],g[t][i]=g[t][i]||[],g[t][i].push(n)}function c(e,t,n){var a,i,r,c=e.split(" ");for(i=c.length;i--;)if(r=c[i],g[t]&&g[t][r]&&g[t][r].length)for(a=g[t][r].length;a--;)g[t][r][a]===n&&g[t][r].splice(a,1)}function o(e,t){var n,a=0;if(s[t].updated&&g[t]&&g[t][e]&&g[t][e].length)for(n=g[t][e].length;n>a;a++)g[t][e][a](e,t)}function u(e){return w[e].currentValue||w[e].getCurrentValue()}function f(e){return-1!==v.indexOf(e)}var l,s,d=0,h=!1,w={},p=[],m=[],v=[],g={},E=window,O=document,x=O.body,b=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};return{init:i,on:r,off:c,prop:w,getPluginValue:u,isActive:f}});