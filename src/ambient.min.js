!function(e,t){"function"==typeof define&&define.amd?define(function(){return e.ambient=t()}):"object"==typeof exports?module.exports=e.ambient=t():e.ambient=t()}(this,function(){function e(){y(t)}function t(){var e,t,i,a,r,c={};m=[];for(e in s)if(s.hasOwnProperty(e)){a=[],s[e].updated=!1;for(t in s[e])if(s[e].hasOwnProperty(t)&&p[t]){if(i=p[t],null==c[t]&&(c[t]=i.getCurrentValue(),c[t]!==i.currentValue?(i.currentValue=c[t],i.updated=!0):i.updated=!1),s[e].updated=s[e].updated||i.updated,i.updated?(r=i.getActiveClasses(i.currentValue,e,s[e][t]),i.cache[e].activeClasses=r):r=i.cache[e].activeClasses,!r.length){a=[];break}a=a.concat(r)}m=m.concat(a)}m=m.filter(function(e,t,n){return n.indexOf(e)===t}),n(),l=null}function n(){var e,t,n=x.className;for(g=n.split(" ").filter(function(e){return-1!==w.indexOf(e)}),e=m.length;e--;)t=m[e],-1===g.indexOf(t)&&(n+=" "+t,s[t]&&o("enter",t)),s[t]&&o("update",t);for(e=g.length;e--;)t=g[e],-1===m.indexOf(t)&&(n=n.replace(new RegExp("(^|\\s)"+t+"($|\\s)","g")," "),s[t]&&o("leave",t));x.className=n.split(" ").filter(function(e){return e}).join(" ")}function i(){l||(d?l=setTimeout(e,d):e())}function a(e,n){var a,r,c,o,u,f,l={};if(!h){s=e||{},w=[];for(a in s)if(s.hasOwnProperty(a))for(c in s[a])if(s[a].hasOwnProperty(c)&&p[c])for(r=p[c],r.cache=r.cache||{},r.cache[a]=r.cache[a]||{},r.watchElement=r.watchElement||E,o=r.getAllClasses?r.getAllClasses(a,s[a][c]):[a],w=w.concat(o),"string"==typeof r.watchEvent&&(r.watchEvent=[r.watchEvent]),u=r.watchEvent.length;u--;)f=r.watchEvent[u],l[f]&&-1!==l[f].indexOf(r.watchElement)||(r.watchElement.addEventListener?r.watchElement.addEventListener(f,i,!1):r.watchElement.attachEvent("on"+f,i),l[f]=l[f]||[],l[f].push(r.watchElement));"number"==typeof n&&(d=n),h=!0,t()}}function r(e,t,n){var i,a,r=e.split(" ");for(v[t]=v[t]||{},i=r.length;i--;)a=r[i],v[t][a]=v[t][a]||[],v[t][a].push(n)}function c(e,t,n){var i,a,r,c=e.split(" ");for(a=c.length;a--;)if(r=c[a],v[t]&&v[t][r]&&v[t][r].length)for(i=v[t][r].length;i--;)v[t][r][i]===n&&v[t][r].splice(i,1)}function o(e,t){var n,i=0;if(s[t].updated&&v[t]&&v[t][e]&&v[t][e].length)for(n=v[t][e].length;n>i;i++)v[t][e][i](e,t)}function u(e){return p[e].currentValue||p[e].getCurrentValue()}function f(e){return-1!==g.indexOf(e)}var l,s,d=0,h=!1,p={},w=[],m=[],g=[],v={},E=window,O=document,x=O.body,y=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};return{init:a,on:r,off:c,prop:p,getPluginValue:u,isActive:f}});